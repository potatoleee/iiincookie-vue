import{A as D,S as A,a as V}from"./swiper-fce122d8.js";import{aN as u,aD as r,X as d,a4 as p,Y as t,F as h,aL as g,a_ as n,bm as B,bd as q,as as m,W as b,bk as f,a3 as E,U as N}from"./@vue-9b9f1f8d.js";import{g as _}from"./gsap-8fc7659c.js";import{S as y}from"./split-type-cdcb87fd.js";import{c as w}from"./cartStore-19166685.js";import{f as U}from"./favoriteStore-8b93b047.js";import{m as x,a as F}from"./pinia-a78a79b1.js";import{_ as R}from"./index-918518a4.js";import"./ssr-window-c9202916.js";import"./axios-bff3f665.js";import"./toast-1797c5ef.js";import"./sweetalert2-2726e422.js";import"./@ckeditor-f5fb1894.js";import"./vue-cfa7fbc0.js";import"./vue-demi-71ba0ef2.js";import"./vue-router-fe912644.js";import"./aos-dcf01651.js";import"./vue-axios-58a7c26f.js";import"./vue-loading-overlay-7a4b91db.js";import"./vee-validate-aa5cd44a.js";import"./@vee-validate-533577de.js";/* empty css                        */_.registerPlugin(y);const{VITE_APP_URL:P,VITE_APP_PATH:k}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"week3dean",BASE_URL:"/iiincookie-vue/",MODE:"production",DEV:!1,PROD:!0},j={data(){return{product:{},activeIndex:0,images:[],qty:1,productList:[],modules:[D],routeID:"",isLoading:!0,showAddToCartBtn:!1,carouselProducts:[]}},components:{Swiper:A,SwiperSlide:V},methods:{...x(U,["toggleFavorite","isFavorite"]),handleScroll(){const e=document.querySelector("#productDetail").getBoundingClientRect().top;this.showAddToCartBtn=e<=0},getProduct(o){this.$http.get(`${P}/api/${k}/product/${o}`).then(e=>{this.product=e.data.product,this.images=this.product.imagesUrl,this.activeIndex=0,this.getProductList()})},getProductList(){this.isLoading=!0,this.$http.get(`${P}/api/${k}/products/all`).then(o=>{this.productList=this.filterCurrentProduct(o.data.products.reverse(),this.product.id),console.log(this.productList)}).catch(o=>{alert(o.data.message)}).finally(()=>{this.isLoading=!1})},filterCurrentProduct(o,e){return o.filter(l=>l.id!==e)},switchImage(o){this.activeIndex=o},handleSwiperSlideChange(o){const e=o.previousIndex,l=o.activeIndex;if(Math.abs(l-e)===1){const s=this.filteredProducts[l%this.filteredProducts.length],c=this.carouselProducts.indexOf(this.lastProduct);c>=0?this.carouselProducts.splice(c,1,s):(this.carouselProducts.shift(),this.carouselProducts.push(s)),this.lastProduct=s}else this.carouselProducts=this.filteredProducts.slice(l,l+4),this.lastProduct=this.carouselProducts[0]},...x(w,["addToCart","addNum","decreaseNum"])},computed:{...F(w,["loadingItem"]),id(){return this.$route.params.id},filteredProducts(){return this.filterCurrentProduct(this.productList,this.product.id).filter(e=>!this.carouselProducts.includes(e))}},watch:{id(o){this.routeID=o,this.$route.name==="product"&&this.getProduct(this.routeID)}},mounted(){const o=this.$refs.splitProductDetail,e=this.$refs.splitProductDetailCh;new y(o),new y(e),e.querySelectorAll(".line").forEach(l=>{l.style.textAlign="end"}),this.$nextTick(()=>{_.fromTo(e.querySelectorAll(".char"),{y:0,opacity:0},{y:0,x:0,opacity:1,stagger:.05,delay:1,duration:.2}),_.fromTo(o.querySelectorAll(".char"),{y:0,opacity:0},{y:0,x:0,opacity:1,stagger:.05,delay:1,duration:.2});const l=document.querySelectorAll(".mask-bg");_.to(l,{duration:1,width:"0%",ease:"power3.inOut"})}),this.routeID=this.$route.params.id,this.getProduct(this.routeID),window.addEventListener("scroll",this.handleScroll)},beforeUnmount(){window.removeEventListener("scroll",this.handleScroll)}},O={class:"title my-10 my-lg-15"},H={class:"title-sub fs-10xl fw-light font-english text-secondary text-opacity-50 d-block text-end",ref:"splitProductDetail"},M={class:"title-main font-serifTc fw-black fs-xl fs-lg-3xl",ref:"splitProductDetailCh"},z={class:"container my-md-13 my-10"},W={class:"justify-content-center"},X={class:"mb-10"},Y={class:"row"},G={class:"col-1 d-none d-lg-block"},J={class:"d-flex flex-column gap-6"},K=["onClick"],Q=["src","alt"],Z={class:"col-lg-6 mb-7 mb-lg-0"},$={class:"product__img"},tt=["src","alt"],st={class:"d-lg-none mb-7"},et={class:"d-flex gap-6"},ot=["onClick"],it=["src","alt"],rt={class:"col-lg-5 d-flex flex-column justify-content-between"},lt={class:"fs-2xl fw-semiBold fs-xl font-serifTc fw-4 mb-2"},dt={class:"fs-sm font-serifTc text-dark text-opacity-70 mb-6"},nt={class:"fs-xl pb-6 mb-6 text-dark font-arimo border-bottom border-dark border-opacity-20 font-serifTc"},ct={class:"mb-6"},at={class:"d-flex gap-6 mb-8"},ut={class:"count border border-secondary-dark d-flex justify-content-between w-100"},pt=["disabled"],ht=t("i",{class:"bi bi-dash-lg"},null,-1),mt=[ht],ft=t("i",{class:"bi bi-plus-lg"},null,-1),_t=[ft],gt={class:"d-flex align-items-center border border-secondary-dark cursor-pointer"},bt={class:"position-relative"},yt={key:0,class:"position-absolute top-0 start-0 w-100 h-100 d-flex justify-content-center align-items-center bg-primary border border-primary"},vt=t("div",{class:"spinner-border text-light spinner-border-sm",role:"status"},[t("span",{class:"sr-only"})],-1),wt=[vt],xt={id:"productDetail",class:"row justify-content-lg-end"},Pt={class:"col-12 col-lg-5"},kt=t("div",{class:"w-100 h-1 bg-dark bg-opacity-20 mb-6"},null,-1),Ct=t("p",{class:"fw-medium mb-6"},"詳細資訊",-1),It={class:"table mb-6"},Tt=t("tr",null,[t("th",{class:"border-0 fw-regular ps-0 fs-sm",width:"120"},"重量"),t("td",{class:"border-0 fs-sm"},"250+-5g")],-1),St=t("th",{class:"border-0 fw-regular ps-0 fs-sm",width:"120"},"內容物",-1),Lt={class:"border-0 fs-sm"},Dt=t("th",{class:"border-0 fw-regular ps-0 fs-sm",width:"120"},"口味",-1),At={class:"border-0 fs-sm"},Vt=t("tr",null,[t("th",{class:"border-0 fw-regular ps-0 fs-sm",width:"120"}," 配送方式 "),t("td",{class:"border-0 fs-sm"},"宅配、自取")],-1),Bt=t("tr",null,[t("th",{class:"border-0 fw-regular ps-0 fs-sm",width:"120"}," 賞味期限 "),t("td",{class:"border-0 fs-sm"},"30天")],-1),qt=t("tr",null,[t("th",{class:"border-0 fw-regular ps-0 fs-sm",width:"120"}," 保存方式 "),t("td",{class:"border-0 fs-sm"},"天氣高溫時放於冰箱")],-1),Et=t("div",{class:"text-center mb-8"},[t("div",{class:"w-100 h-1 bg-dark bg-opacity-20 mb-8"}),t("p",{class:"font-english fs-2xl fs-lg-3xl"},"Other products"),t("p",{class:"fw-medium font-serifTc fs-lg fs-lg-xl"},"其他商品")],-1),Nt={class:"mb-16"},Ut=["src","alt"],Ft={class:"fw-medium mb-2 font-serifTc"},Rt={class:"fs-sm fw-medium mb-2 font-serifTc text-dark text-opacity-80"},jt={class:"font-serifTc"},Ot=t("div",{class:"d-flex gap-1"},[t("div",null,[t("div",{class:"w-2n h-2n bg-secondary-light border-dark border mb-1"}),t("div",{class:"w-2n h-2n bg-secondary-light border-dark border"})]),t("div",null,[t("div",{class:"w-2n h-2n bg-secondary-light border-dark border mb-1"}),t("div",{class:"w-2n h-2n bg-secondary-light border-dark border"})])],-1),Ht=t("p",{class:"fs-2xl font-english"},"Back To List",-1),Mt={key:0,class:"position-absolute top-0 start-0 w-100 h-100 d-flex justify-content-center align-items-center bg-primary border border-primary"},zt=t("div",{class:"spinner-border text-light spinner-border-sm",role:"status"},[t("span",{class:"sr-only"})],-1),Wt=[zt];function Xt(o,e,l,C,s,c){const I=u("VueLoading"),v=u("RouterLink"),T=u("swiper-slide"),S=u("swiper");return r(),d(h,null,[p(I,{active:s.isLoading,"onUpdate:active":e[0]||(e[0]=i=>s.isLoading=i)},null,8,["active"]),t("div",O,[t("span",H,"Product Detail ",512),t("h2",M," 產品細節 ",512)]),t("div",z,[t("div",W,[t("div",X,[t("div",Y,[t("div",G,[t("ul",J,[(r(!0),d(h,null,g(s.images,(i,a)=>(r(),d("li",{key:a,onClick:L=>c.switchImage(a),class:m(["opacity-75",{"opacity-100":a===s.activeIndex}])},[t("img",{src:i,alt:s.product.title},null,8,Q)],10,K))),128))])]),t("div",Z,[t("div",$,[t("img",{src:s.images[s.activeIndex],alt:s.product.title},null,8,tt)])]),t("div",st,[t("ul",et,[(r(!0),d(h,null,g(s.images,(i,a)=>(r(),d("li",{key:a,onClick:L=>c.switchImage(a),class:m(["opacity-75 w-20",{"opacity-100":a===s.activeIndex}])},[t("img",{src:i,alt:s.product.title},null,8,it)],10,ot))),128))])]),t("div",rt,[t("div",null,[t("h1",lt,n(s.product.title),1),t("p",dt,n(s.product.flavor),1),t("p",nt," NT$ "+n(s.product.price),1),t("p",ct,n(s.product.description),1)]),t("div",null,[t("div",at,[t("div",ut,[t("button",{class:"btn rounded-0",onClick:e[1]||(e[1]=i=>s.qty--),disabled:s.qty===1},mt,8,pt),B(t("input",{class:"text-center bg-secondary-light w-80 border-0 text-dark",type:"number",min:"1","onUpdate:modelValue":e[2]||(e[2]=i=>s.qty=i),readonly:""},null,512),[[q,s.qty]]),t("button",{class:"btn rounded-0",onClick:e[3]||(e[3]=i=>s.qty++)},_t)]),t("div",gt,[o.isFavorite(s.product)?(r(),d("i",{key:0,class:"bi bi-heart-fill text-primary py-2 px-3",onClick:e[4]||(e[4]=i=>o.toggleFavorite(s.product))})):(r(),d("i",{key:1,class:"bi bi-heart text-dark py-2 px-3",onClick:e[5]||(e[5]=i=>o.toggleFavorite(s.product))}))])]),t("div",bt,[t("button",{type:"button",class:m(["btn btn-primary text-secondary-light w-100 py-4 rounded-0 letter-spacing-2",{disabled:s.product.id===o.loadingItem}]),onClick:e[6]||(e[6]=i=>o.addToCart(s.product.id,s.qty))}," 加入購物車 ",2),s.product.id===o.loadingItem?(r(),d("div",yt,wt)):b("",!0)])])])])])]),t("div",xt,[t("div",Pt,[kt,Ct,t("table",It,[t("tbody",null,[Tt,t("tr",null,[St,t("td",Lt,n(s.product.content),1)]),t("tr",null,[Dt,t("td",At,n(s.product.flavor),1)]),Vt,Bt,qt])])])]),Et,t("div",Nt,[p(S,{"slides-per-view":1,autoplay:{delay:2500,disableOnInteraction:!1},loop:!0,"space-between":50,modules:s.modules,breakpoints:{768:{slidesPerView:2,spaceBetween:24},992:{slidesPerView:3,spaceBetween:24}}},{default:f(()=>[(r(!0),d(h,null,g(c.filteredProducts,i=>(r(),N(T,{key:i.id,onSlideChange:c.handleSwiperSlideChange},{default:f(()=>[p(v,{to:`/product/${i.id}`,class:"mb-7 imgHover"},{default:f(()=>[t("img",{src:i.imageUrl,alt:i.title},null,8,Ut)]),_:2},1032,["to"]),t("p",Ft,n(i.title),1),t("p",Rt,n(i.flavor),1),t("p",jt,"NT$ "+n(i.price),1)]),_:2},1032,["onSlideChange"]))),128))]),_:1},8,["modules"])]),t("div",null,[p(v,{to:"/products",class:"d-flex flex-row-reverse align-items-center gap-5"},{default:f(()=>[Ot,Ht]),_:1})])]),s.showAddToCartBtn?(r(),d("button",{key:0,type:"button",class:m(["d-md-none z-1 position-fixed bottom-0 start-0 btn btn-primary text-secondary-light w-100 py-4 rounded-0 letter-spacing-2",{disabled:s.product.id===o.loadingItem}]),onClick:e[7]||(e[7]=i=>o.addToCart(s.product.id,s.qty))},[E(" 加入購物車 "),s.product.id===o.loadingItem?(r(),d("div",Mt,Wt)):b("",!0)],2)):b("",!0)],64)}const fs=R(j,[["render",Xt]]);export{fs as default};
