import{P as k,D as v}from"./PaginationComponent-b8e54531.js";import{M as C}from"./bootstrap-1e9f360c.js";import{aD as n,X as a,Y as e,a3 as D,a_ as r,bm as P,b9 as T,F as g,aL as M,aN as _,a4 as b}from"./@vue-9b9f1f8d.js";import{_ as $}from"./index-884024c5.js";import{T as c}from"./toast-1797c5ef.js";import"./@popperjs-9847b28c.js";import"./pinia-a78a79b1.js";import"./vue-demi-71ba0ef2.js";import"./vue-router-fe912644.js";import"./aos-dcf01651.js";import"./@ckeditor-f5fb1894.js";import"./vue-cfa7fbc0.js";import"./axios-bff3f665.js";import"./vue-axios-58a7c26f.js";import"./vue-loading-overlay-7a4b91db.js";import"./vee-validate-aa5cd44a.js";import"./@vee-validate-533577de.js";/* empty css                        */import"./gsap-8fc7659c.js";import"./sweetalert2-2726e422.js";const w={props:{innerTempOrder:{type:Object,default(){return{}}}},data(){return{orderModal:"",tempOrder:{}}},methods:{orderConfirm(){this.$emit("orderConfirm",this.tempOrder)},show(){this.orderModal.show()},hide(){this.orderModal.hide()}},watch:{innerTempOrder(){this.tempOrder=this.innerTempOrder}},mounted(){this.orderModal=new C(this.$refs.orderModal)}},x={id:"orderModal",class:"modal fade",tabindex:"-1","aria-labelledby":"orderModalLabel","aria-hidden":"true",ref:"orderModal"},L={class:"modal-dialog modal-xl"},I={class:"modal-content border-0"},V=e("div",{class:"modal-header bg-dark text-white"},[e("h5",{id:"orderModalLabel",class:"modal-title"},[e("span",null,"編輯訂單")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),A={class:"modal-body"},E=e("p",null,"訂單資訊",-1),N={class:"form-check"},B={class:"form-check-label",for:"is_paid"},R=e("h3",null,"客戶資訊",-1),U=e("h3",null,"訂單品項",-1),S={class:"table"},F=e("thead",null,[e("tr",null,[e("th",null,"品項"),e("th",null,"單價"),e("th",null,"數量"),e("th",null,"小計")])],-1),G={class:"text-end"},H={class:"modal-footer"};function j(s,t,m,y,o,i){var p,h,u,l;return n(),a("div",x,[e("div",L,[e("div",I,[V,e("div",A,[E,D(" "+r(o.tempOrder.id)+" ",1),e("div",N,[P(e("input",{id:"is_paid",class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=d=>o.tempOrder.is_paid=d),"true-value":!0,"false-value":!1},null,512),[[T,o.tempOrder.is_paid]]),e("label",B,r(o.tempOrder.is_paid?"已付款":"未付款"),1)]),R,e("ul",null,[e("li",null,"客戶姓名："+r((p=o.tempOrder.user)==null?void 0:p.name),1),e("li",null,"聯絡電話："+r((h=o.tempOrder.user)==null?void 0:h.tel),1),e("li",null,"電子信箱："+r((u=o.tempOrder.user)==null?void 0:u.email),1),e("li",null,"寄送地址："+r((l=o.tempOrder.user)==null?void 0:l.address),1),e("li",null,"備註："+r(o.tempOrder.message),1)]),U,e("div",null,[e("table",S,[F,e("tbody",null,[(n(!0),a(g,null,M(o.tempOrder.products,d=>(n(),a("tr",{key:d.products},[e("td",null,r(d.product.title),1),e("td",null,"NT$ "+r(d.product.price),1),e("td",null,r(d.qty),1),e("td",null,"NT$ "+r(d.total),1)]))),128))])])]),e("div",G,[e("p",null,"總計：NT$ "+r(o.tempOrder.total),1)])]),e("div",H,[e("button",{type:"button",class:"btn btn-outline-secondary",onClick:t[1]||(t[1]=(...d)=>i.hide&&i.hide(...d))}," 取消 "),e("button",{type:"button",class:"btn btn-primary text-light",onClick:t[2]||(t[2]=(...d)=>i.orderConfirm&&i.orderConfirm(...d))}," 確認 ")])])])],512)}const q=$(w,[["render",j]]),{VITE_APP_URL:f,VITE_APP_PATH:O}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"week3dean",BASE_URL:"/iiincookie-vue/",MODE:"production",DEV:!1,PROD:!0},X={data(){return{pagination:{},orderData:[],tempOrder:{}}},methods:{getOrderList(s=1){this.$http.get(`${f}/api/${O}/admin/orders/?page=${s}`).then(t=>{this.orderData=t.data.orders,this.pagination=t.data.pagination}).catch(t=>{c.fire({icon:"error",title:`${t.response.data.message}`})})},formatDate(s){return new Date(s*1e3).toLocaleString()},openModal(s,t){s==="edit"?(this.$refs.orderModal.show(),this.tempOrder={...t}):s==="delete"&&(this.$refs.deleteModal.show(),this.tempOrder={...t})},deleteOrder(){this.$http.delete(`${f}/api/${O}/admin/order/${this.tempOrder.id}`).then(s=>{c.fire({icon:"success",title:`${s.data.message}`}),this.$refs.deleteModal.hide(),this.getOrderList()}).catch(s=>{c.fire({icon:"error",title:`${s.response.data.message}`})})},editOrderModal(s){const t={is_paid:s.is_paid};this.$http.put(`${f}/api/${O}/admin/order/${s.id}`,{data:t}).then(m=>{c.fire({icon:"success",title:`${m.data.message}`}),this.$refs.orderModal.hide(),this.getOrderList()}).catch(m=>{c.fire({icon:"error",title:`${m.response.data.message}`})})}},mounted(){this.getOrderList()},components:{PaginationComponent:k,DeleteModal:v,OrderModal:q}},Y=e("h1",{class:"fs-2xl border-bottom border-secondary pb-2"},"訂單管理",-1),z={class:"table mt-4"},J=e("thead",null,[e("tr",null,[e("th",{width:"120"},"訂單日期"),e("th",{width:"120"},"訂單編號"),e("th",{width:"120"},"聯絡人"),e("th",{width:"120"},"金額"),e("th",{width:"100"},"付款狀態"),e("th",{width:"120"},"編輯")])],-1),K={key:0,class:"text-success"},Q={key:1},W={class:"btn-group"},Z=["onClick"],ee=["onClick"];function te(s,t,m,y,o,i){const p=_("PaginationComponent"),h=_("OrderModal"),u=_("DeleteModal");return n(),a(g,null,[Y,e("table",z,[J,e("tbody",null,[(n(!0),a(g,null,M(o.orderData,l=>(n(),a("tr",{key:l.id},[e("td",null,r(i.formatDate(l.create_at)),1),e("td",null,r(l.id),1),e("td",null,r(l.user.name)+" "+r(l.user.email),1),e("td",null,"NT$"+r(l.total),1),e("td",null,[l.is_paid?(n(),a("span",K,"已付款")):(n(),a("span",Q,"未付款"))]),e("td",null,[e("div",W,[e("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:d=>i.openModal("edit",l)}," 編輯 ",8,Z),e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:d=>i.openModal("delete",l)}," 刪除 ",8,ee)])])]))),128))])]),b(p,{"page-in":o.pagination,onGetPages:i.getOrderList},null,8,["page-in","onGetPages"]),b(h,{"inner-temp-order":o.tempOrder,onOrderConfirm:i.editOrderModal,ref:"orderModal"},null,8,["inner-temp-order","onOrderConfirm"]),b(u,{deleteItem:o.tempOrder,deleteModalTitle:"訂單",onDelItem:i.deleteOrder,ref:"deleteModal"},null,8,["deleteItem","onDelItem"])],64)}const ye=$(X,[["render",te]]);export{ye as default};
