import{M as y}from"./bootstrap-1e9f360c.js";import{b as T}from"./@ckeditor-75295a52.js";import{U as D}from"./UploadImages-928f0e01.js";import{S as V}from"./sweetalert2-aca7abf3.js";import{aN as m,aD as n,U as r,W as t,a2 as p,bm as c,bd as d,b9 as U,a_ as h,F as g,aL as x}from"./@vue-01f76383.js";import{_ as v}from"./index-00af039d.js";import{D as E}from"./DeleteModal-cbd76290.js";import{P as I}from"./PaginationComponent-d1cad817.js";import"./@popperjs-9847b28c.js";import"./vue-00609181.js";import"./pinia-6b383ae9.js";import"./vue-demi-71ba0ef2.js";import"./vue-router-878122eb.js";import"./axios-bff3f665.js";import"./vue-axios-58a7c26f.js";import"./vue-loading-overlay-449b88b9.js";import"./vee-validate-939181b4.js";import"./@vee-validate-533577de.js";/* empty css                        */import"./gsap-8fc7659c.js";const{VITE_APP_URL:w,VITE_APP_PATH:P}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"week3dean",BASE_URL:"/iiincookie-vue/",MODE:"production",DEV:!1,PROD:!0},L={props:["isNew","innerTempArticle"],data(){return{tempArticle:{},articleModal:"",create_at:0,content:"",editor:T,editorConfig:{toolbar:["heading","|","bold","italic","|","link","bulletedList","numberedList","|","undo","redo"]}}},methods:{confirm(){let i="post",e=`${w}/api/${P}/admin/article`;this.isNew===!1&&(i="put",e=`${w}/api/${P}/admin/article/${this.tempArticle.id}`),this.$http[i](e,{data:this.tempArticle}).then(()=>{V.fire({position:"top-end",icon:"success",title:"已更新文章",showConfirmButton:!1,timer:800}),this.articleModal.hide(),this.$emit("update")}).catch(_=>{alert(_.response.data.message)})},show(){this.articleModal.show()},hide(){this.articleModal.hide()}},watch:{innerTempArticle(){this.tempArticle=this.innerTempArticle;const i=new Date(this.tempArticle.create_at*1e3).toISOString().split("T");this.create_at=i[0]},create_at(){this.tempArticle.create_at=Math.floor(new Date(this.create_at)/1e3)}},mounted(){this.articleModal=new y(this.$refs.articleModal),console.log(this.tempData)},components:{UploadImages:D}},C={id:"articleModal",class:"modal fade",tabindex:"-1","aria-labelledby":"articleModalabel","aria-hidden":"true",ref:"articleModal"},$={class:"modal-dialog modal-xl"},N={class:"modal-content border-0"},R={class:"modal-header bg-dark text-white"},S={id:"articleModalLabel",class:"modal-title"},B={key:0},H={key:1},O=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),F={class:"modal-body"},G={class:"row"},z={class:"mb-3 col-md-12"},W=t("label",{for:"article_image",class:"form-label"},"文章圖片網址",-1),j=["src"],q={class:"row"},J={class:"mb-3 col-md-12"},K=t("label",{for:"article_title",class:"form-label"},"文章標題",-1),Q={class:"row"},X={class:"mb-3 col-md-12"},Y=t("label",{for:"article_create_at",class:"form-label"},"創立時間",-1),Z={class:"row"},tt={class:"mb-3 col-md-12"},et=t("label",{for:"article_author",class:"form-label"},"文章作者",-1),ot={class:"row"},it={class:"mb-3 col-md-12"},lt=t("label",{for:"article_description",class:"form-label"},"文章描述",-1),st={class:"row"},at=t("div",{class:"mb-3 col-md-12"},[t("p",null,"文章內容")],-1),nt={class:"w-100"},rt={class:"row"},ct={class:"mb-3 col-md-12"},dt=t("label",{for:"article_tag",class:"form-label"},"文章標籤",-1),mt={class:"form-check"},pt={class:"form-check-label",for:"isPublic"},ht={class:"modal-footer"};function _t(i,e,_,M,o,s){const u=m("UploadImages"),b=m("ckeditor");return n(),r("div",C,[t("div",$,[t("div",N,[t("div",R,[t("h5",S,[_.isNew?(n(),r("span",B,"新增文章")):(n(),r("span",H,"編輯文章"))]),O]),t("div",F,[p(u),t("div",G,[t("div",z,[W,c(t("input",{id:"article_image",type:"text",class:"form-control",placeholder:"請輸入文章圖片網址","onUpdate:modelValue":e[0]||(e[0]=l=>o.tempArticle.image=l)},null,512),[[d,o.tempArticle.image]])]),t("img",{class:"img-fluid",src:o.tempArticle.image},null,8,j)]),t("div",q,[t("div",J,[K,c(t("input",{id:"article_title",type:"text",class:"form-control",placeholder:"請輸入文章標題","onUpdate:modelValue":e[1]||(e[1]=l=>o.tempArticle.title=l)},null,512),[[d,o.tempArticle.title]])])]),t("div",Q,[t("div",X,[Y,c(t("input",{id:"article_create_at",type:"date",class:"form-control",placeholder:"請輸入文章標題","onUpdate:modelValue":e[2]||(e[2]=l=>o.create_at=l)},null,512),[[d,o.create_at]])])]),t("div",Z,[t("div",tt,[et,c(t("input",{id:"article_author",type:"text",class:"form-control",placeholder:"請輸入文章作者","onUpdate:modelValue":e[3]||(e[3]=l=>o.tempArticle.author=l)},null,512),[[d,o.tempArticle.author]])])]),t("div",ot,[t("div",it,[lt,c(t("input",{id:"article_description",type:"text",class:"form-control",placeholder:"請輸入文章標題","onUpdate:modelValue":e[4]||(e[4]=l=>o.tempArticle.description=l)},null,512),[[d,o.tempArticle.description]])])]),t("div",st,[at,t("div",nt,[p(b,{editor:o.editor,modelValue:o.tempArticle.content,"onUpdate:modelValue":e[5]||(e[5]=l=>o.tempArticle.content=l),config:o.editorConfig},null,8,["editor","modelValue","config"])])]),t("div",rt,[t("div",ct,[dt,c(t("input",{id:"article_tag",type:"text",class:"form-control",placeholder:"請輸入文章標題","onUpdate:modelValue":e[6]||(e[6]=l=>o.tempArticle.tag=l)},null,512),[[d,o.tempArticle.tag]])])]),t("div",mt,[c(t("input",{id:"isPublic",class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=l=>o.tempArticle.isPublic=l),"true-value":!0,"false-value":!1},null,512),[[U,o.tempArticle.isPublic]]),t("label",pt,h(o.tempArticle.isPublic?"啟用":"不啟用"),1)])]),t("div",ht,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:e[8]||(e[8]=(...l)=>s.hide&&s.hide(...l))}," 取消 "),t("button",{type:"button",class:"btn btn-primary",onClick:e[9]||(e[9]=(...l)=>s.confirm&&s.confirm(...l))},h(this.isNew?"新增文章":"更新文章"),1)])])])],512)}const ut=v(L,[["render",_t]]),{VITE_APP_URL:f,VITE_APP_PATH:A}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"week3dean",BASE_URL:"/iiincookie-vue/",MODE:"production",DEV:!1,PROD:!0},bt={data(){return{articles:[],pagination:{},isNew:!1,tempArticle:{}}},methods:{openModal(i,e){i==="new"?(this.tempArticle={create_at:new Date().getTime()/1e3,isPublic:!0,tag:[],content:""},this.$refs.articleModal.show(),this.isNew=!0):i==="edit"?(this.$refs.articleModal.show(),this.tempArticle={...e},this.isNew=!1):i==="delete"&&(this.$refs.deleteModal.show(),this.tempArticle={...e},this.isNew=!1)},getArticleList(i=1){this.$http.get(`${f}/api/${A}/admin/articles/?page=${i}`).then(e=>{console.log(e.data),this.pagination=e.data.pagination,this.articles=e.data.articles}).catch(e=>{alert(e.response.data.message)})},openArticle(i){this.$http.get(`${f}/api/${A}/admin/article/${i.id}`).then(e=>{console.log(e.data),this.tempArticle=e.data.article,this.$refs.articleModal.show()}).catch(e=>{alert(e.response.data.message)})},formatDate(i){return new Date(i*1e3).toLocaleDateString()},deleteArticle(){this.$http.delete(`${f}/api/${A}/admin/article/${this.tempArticle.id}`).then(i=>{alert(i.data.message),this.$refs.deleteModal.hide(),this.getArticleList()}).catch(i=>{alert(i.response.data.message)})}},mounted(){const i=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=i,this.getArticleList()},components:{ArticleModal:ut,DeleteModal:E,PaginationComponent:I}},ft=t("h1",{class:"fs-2xl border-bottom border-secondary pb-2"},"文章管理",-1),At={class:"text-end mt-4"},gt={class:"table mt-4"},wt=t("thead",null,[t("tr",null,[t("th",{width:"120"},"文章標題"),t("th",{width:"120"},"標籤"),t("th",{width:"120"},"創建日"),t("th",{width:"100"},"是否發佈"),t("th",{width:"120"},"編輯")])],-1),Pt={key:0,class:"text-success"},vt={key:1},Mt={class:"btn-group"},kt=["onClick"],yt=["onClick"];function Tt(i,e,_,M,o,s){const u=m("PaginationComponent"),b=m("ArticleModal"),l=m("DeleteModal");return n(),r(g,null,[ft,t("div",At,[t("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=a=>s.openModal("new",i.article))}," 建立新文章 ")]),t("table",gt,[wt,t("tbody",null,[(n(!0),r(g,null,x(o.articles,a=>(n(),r("tr",{key:a.id},[t("td",null,h(a.title),1),t("td",null,h(a.tag),1),t("td",null,h(s.formatDate(a.create_at)),1),t("td",null,[a.isPublic?(n(),r("span",Pt,"已啟用")):(n(),r("span",vt,"未啟用"))]),t("td",null,[t("div",Mt,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:k=>s.openArticle(a)}," 編輯 ",8,kt),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:k=>s.openModal("delete",a)}," 刪除 ",8,yt)])])]))),128))])]),p(u,{"page-in":o.pagination,onGetPages:s.getArticleList},null,8,["page-in","onGetPages"]),p(b,{ref:"articleModal",innerTempArticle:o.tempArticle,isNew:o.isNew,onUpdate:s.getArticleList},null,8,["innerTempArticle","isNew","onUpdate"]),p(l,{deleteItem:o.tempArticle,onDelItem:s.deleteArticle,ref:"deleteModal"},null,8,["deleteItem","onDelItem"])],64)}const qt=v(bt,[["render",Tt]]);export{qt as default};
