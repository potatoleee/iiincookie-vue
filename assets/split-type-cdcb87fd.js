(()=>{function t(...n){const r=n.length;for(let i=0;i<r;i++){const o=n[i];o.nodeType===1||o.nodeType===11?this.appendChild(o):this.appendChild(document.createTextNode(String(o)))}}function e(...n){for(;this.lastChild;)this.removeChild(this.lastChild);n.length&&this.append(...n)}function s(...n){const r=this.parentNode;let i=n.length;if(r)for(i||r.removeChild(this);i--;){let o=n[i];typeof o!="object"?o=this.ownerDocument.createTextNode(o):o.parentNode&&o.parentNode.removeChild(o),i?r.insertBefore(this.previousSibling,o):r.replaceChild(o,this)}}typeof Element<"u"&&(Element.prototype.append||(Element.prototype.append=t,DocumentFragment.prototype.append=t),Element.prototype.replaceChildren||(Element.prototype.replaceChildren=e,DocumentFragment.prototype.replaceChildren=e),Element.prototype.replaceWith||(Element.prototype.replaceWith=s,DocumentFragment.prototype.replaceWith=s))})();function E(t,e){return Object.getOwnPropertyNames(Object(t)).reduce((s,n)=>{const r=Object.getOwnPropertyDescriptor(Object(t),n),i=Object.getOwnPropertyDescriptor(Object(e),n);return Object.defineProperty(s,n,i||r)},{})}function T(t){return typeof t=="string"}function V(t){return Array.isArray(t)}function L(t={}){const e=E(t);let s;return e.types!==void 0?s=e.types:e.split!==void 0&&(s=e.split),s!==void 0&&(e.types=(T(s)||V(s)?String(s):"").split(",").map(n=>String(n).trim()).filter(n=>/((line)|(word)|(char))/i.test(n))),(e.absolute||e.position)&&(e.absolute=e.absolute||/absolute/.test(t.position)),e}function H(t){const e=T(t)||V(t)?String(t):"";return{none:!e,lines:/line/i.test(e),words:/word/i.test(e),chars:/char/i.test(e)}}function D(t){return t!==null&&typeof t=="object"}function ct(t){return D(t)&&/^(1|3|11)$/.test(t.nodeType)}function lt(t){return typeof t=="number"&&t>-1&&t%1===0}function at(t){return D(t)&&lt(t.length)}function S(t){return V(t)?t:t==null?[]:at(t)?Array.prototype.slice.call(t):[t]}function v(t){let e=t;return T(t)&&(/^(#[a-z]\w+)$/.test(t.trim())?e=document.getElementById(t.trim().slice(1)):e=document.querySelectorAll(t)),S(e).reduce((s,n)=>[...s,...S(n).filter(ct)],[])}const{entries:ft,keys:Rt,values:Dt}=Object,R="_splittype",w={};let pt=0;function u(t,e,s){if(!D(t))return console.warn("[data.set] owner is not an object"),null;const n=t[R]||(t[R]=++pt),r=w[n]||(w[n]={});return s===void 0?e&&Object.getPrototypeOf(e)===Object.prototype&&(w[n]={...r,...e}):e!==void 0&&(r[e]=s),s}function $(t,e){const s=D(t)?t[R]:null,n=s&&w[s]||{};return e===void 0?n:n[e]}function I(t){const e=t&&t[R];e&&(delete t[e],delete w[e])}function ht(){ft(w).forEach(([t,{isRoot:e,isSplit:s}])=>{(!e||!s)&&(w[t]=null,delete w[t])})}function dt(t,e=" "){return(t?String(t):"").trim().replace(/\s+/g," ").split(e)}const z="\\ud800-\\udfff",X="\\u0300-\\u036f\\ufe20-\\ufe23",k="\\u20d0-\\u20f0",q="\\ufe0e\\ufe0f",ut=`[${z}]`,F=`[${X}${k}]`,M="\\ud83c[\\udffb-\\udfff]",yt=`(?:${F}|${M})`,G=`[^${z}]`,J="(?:\\ud83c[\\udde6-\\uddff]){2}",_="[\\ud800-\\udbff][\\udc00-\\udfff]",Z="\\u200d",K=`${yt}?`,Q=`[${q}]?`,gt="(?:"+Z+"(?:"+[G,J,_].join("|")+")"+Q+K+")*",wt=Q+K+gt,mt=`(?:${[`${G}${F}?`,F,J,_,ut].join("|")}
)`,bt=RegExp(`${M}(?=${M})|${mt}${wt}`,"g"),Ct=[Z,z,X,k,q],Et=RegExp(`[${Ct.join("")}]`);function $t(t){return t.split("")}function tt(t){return Et.test(t)}function St(t){return t.match(bt)||[]}function xt(t){return tt(t)?St(t):$t(t)}function At(t){return t==null?"":String(t)}function Wt(t,e=""){return t=At(t),t&&T(t)&&!e&&tt(t)?xt(t):t.split(e)}function P(t,e){const s=document.createElement(t);return e&&Object.keys(e).forEach(n=>{const r=e[n],i=T(r)?r.trim():r;i===null||i===""||(n==="children"?s.append(...S(i)):s.setAttribute(n,i))}),s}var U={splitClass:"",lineClass:"line",wordClass:"word",charClass:"char",types:["lines","words","chars"],absolute:!1,tagName:"div"};function Ot(t,e){e=E(U,e);const s=H(e.types),n=e.tagName,r=t.nodeValue,i=document.createDocumentFragment();let o=[],l=[];return/^\s/.test(r)&&i.append(" "),o=dt(r).reduce((a,y,x,m)=>{let g,p;return s.chars&&(p=Wt(y).map(b=>{const d=P(n,{class:`${e.splitClass} ${e.charClass}`,style:"display: inline-block;",children:b});return u(d,"isChar",!0),l=[...l,d],d})),s.words||s.lines?(g=P(n,{class:`${e.wordClass} ${e.splitClass}`,style:`display: inline-block; ${s.words&&e.absolute?"position: relative;":""}`,children:s.chars?p:y}),u(g,{isWord:!0,isWordStart:!0,isWordEnd:!0}),i.appendChild(g)):p.forEach(b=>{i.appendChild(b)}),x<m.length-1&&i.append(" "),s.words?a.concat(g):a},[]),/\s$/.test(r)&&i.append(" "),t.replaceWith(i),{words:o,chars:l}}function et(t,e){const s=t.nodeType,n={words:[],chars:[]};if(!/(1|3|11)/.test(s))return n;if(s===3&&/\S/.test(t.nodeValue))return Ot(t,e);const r=S(t.childNodes);if(r.length&&(u(t,"isSplit",!0),!$(t).isRoot)){t.style.display="inline-block",t.style.position="relative";const i=t.nextSibling,o=t.previousSibling,l=t.textContent||"",a=i?i.textContent:" ",y=o?o.textContent:" ";u(t,{isWordEnd:/\s$/.test(l)||/^\s/.test(a),isWordStart:/^\s/.test(l)||/\s$/.test(y)})}return r.reduce((i,o)=>{const{words:l,chars:a}=et(o,e);return{words:[...i.words,...l],chars:[...i.chars,...a]}},n)}function Tt(t,e,s,n){if(!s.absolute)return{top:e?t.offsetTop:null};const r=t.offsetParent,[i,o]=n;let l=0,a=0;if(r&&r!==document.body){const d=r.getBoundingClientRect();l=d.x+i,a=d.y+o}const{width:y,height:x,x:m,y:g}=t.getBoundingClientRect(),p=g+o-a,b=m+i-l;return{width:y,height:x,top:p,left:b}}function st(t){$(t).isWord?(I(t),t.replaceWith(...t.childNodes)):S(t.children).forEach(e=>st(e))}const jt=()=>document.createDocumentFragment();function Nt(t,e,s){const n=H(e.types),r=e.tagName,i=t.getElementsByTagName("*"),o=[];let l=[],a=null,y,x,m,g=[];const p=t.parentElement,b=t.nextElementSibling,d=jt(),Y=window.getComputedStyle(t),nt=Y.textAlign,it=parseFloat(Y.fontSize)*.2;return e.absolute&&(m={left:t.offsetLeft,top:t.offsetTop,width:t.offsetWidth},x=t.offsetWidth,y=t.offsetHeight,u(t,{cssWidth:t.style.width,cssHeight:t.style.height})),S(i).forEach(c=>{const f=c.parentElement===t,{width:h,height:A,top:C,left:O}=Tt(c,f,e,s);/^br$/i.test(c.nodeName)||(n.lines&&f&&((a===null||C-a>=it)&&(a=C,o.push(l=[])),l.push(c)),e.absolute&&u(c,{top:C,left:O,width:h,height:A}))}),p&&p.removeChild(t),n.lines&&(g=o.map(c=>{const f=P(r,{class:`${e.splitClass} ${e.lineClass}`,style:`display: block; text-align: ${nt}; width: 100%;`});u(f,"isLine",!0);const h={height:0,top:1e4};return d.appendChild(f),c.forEach((A,C,O)=>{const{isWordEnd:j,top:N,height:rt}=$(A),ot=O[C+1];h.height=Math.max(h.height,rt),h.top=Math.min(h.top,N),f.appendChild(A),j&&$(ot).isWordStart&&f.append(" ")}),e.absolute&&u(f,{height:h.height,top:h.top}),f}),n.words||st(d),t.replaceChildren(d)),e.absolute&&(t.style.width=`${t.style.width||x}px`,t.style.height=`${y}px`,S(i).forEach(c=>{const{isLine:f,top:h,left:A,width:C,height:O}=$(c),j=$(c.parentElement),N=!f&&j.isLine;c.style.top=`${N?h-j.top:h}px`,c.style.left=f?`${m.left}px`:`${A-(N?m.left:0)}px`,c.style.height=`${O}px`,c.style.width=f?`${m.width}px`:`${C}px`,c.style.position="absolute"})),p&&(b?p.insertBefore(t,b):p.appendChild(t)),g}let W=E(U,{});class B{static get data(){return w}static get defaults(){return W}static set defaults(e){W=E(W,L(e))}static setDefaults(e){return W=E(W,L(e)),U}static revert(e){v(e).forEach(s=>{const{isSplit:n,html:r,cssWidth:i,cssHeight:o}=$(s);n&&(s.innerHTML=r,s.style.width=i||"",s.style.height=o||"",I(s))})}static create(e,s){return new B(e,s)}constructor(e,s){this.isSplit=!1,this.settings=E(W,L(s)),this.elements=v(e),this.split()}split(e){this.revert(),this.elements.forEach(r=>{u(r,"html",r.innerHTML)}),this.lines=[],this.words=[],this.chars=[];const s=[window.pageXOffset,window.pageYOffset];e!==void 0&&(this.settings=E(this.settings,L(e)));const n=H(this.settings.types);n.none||(this.elements.forEach(r=>{u(r,"isRoot",!0);const{words:i,chars:o}=et(r,this.settings);this.words=[...this.words,...i],this.chars=[...this.chars,...o]}),this.elements.forEach(r=>{if(n.lines||this.settings.absolute){const i=Nt(r,this.settings,s);this.lines=[...this.lines,...i]}}),this.isSplit=!0,window.scrollTo(s[0],s[1]),ht())}revert(){this.isSplit&&(this.lines=null,this.words=null,this.chars=null,this.isSplit=!1),B.revert(this.elements)}}export{B as S};
