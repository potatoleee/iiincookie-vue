import{D as V,P as x}from"./PaginationComponent-185dc492.js";import{U as T}from"./UploadImages-44d0d093.js";import{M as A}from"./bootstrap-1e9f360c.js";import{T as f}from"./toast-ba4829f6.js";import{aN as _,aD as a,X as n,Y as t,a4 as h,bm as r,bd as c,F as g,aL as U,b9 as I,a_ as u}from"./@vue-9b9f1f8d.js";import{_ as k}from"./index-13dcb442.js";import"./loadingStore-76618adb.js";import"./pinia-a2ec2acd.js";import"./vue-demi-71ba0ef2.js";import"./@popperjs-9847b28c.js";import"./sweetalert2-761b07dd.js";import"./@ckeditor-34cd5b3f.js";import"./vue-d45f05e8.js";import"./vue-router-feb1a2d6.js";import"./axios-bff3f665.js";import"./vue-axios-58a7c26f.js";import"./vue-loading-overlay-89c4fdf0.js";import"./vee-validate-aa5cd44a.js";import"./@vee-validate-533577de.js";/* empty css                        */import"./gsap-8fc7659c.js";const{VITE_APP_URL:D,VITE_APP_PATH:P}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"week3dean",BASE_URL:"/iiincookie-vue/",MODE:"production",DEV:!1,PROD:!0},E={props:["isNew","innerTempData"],data(){return{tempData:JSON.parse(JSON.stringify(this.innerTempData)),editProductModal:""}},methods:{confirm(){let l="post",e=`${D}/api/${P}/admin/product`;this.isNew===!1&&(l="put",e=`${D}/api/${P}/admin/product/${this.tempData.id}`),this.$http[l](e,{data:this.tempData}).then(m=>{f.fire({icon:"success",title:`${m.data.message}`}),this.editProductModal.hide(),this.$emit("update")}).catch(m=>{f.fire({icon:"error",title:`${m.response.data.message}`})})},createImage(){this.tempData.imagesUrl=[],this.tempData.imagesUrl.push("")},show(){this.editProductModal.show()},hide(){this.editProductModal.hide()}},watch:{innerTempData(){this.tempData=this.innerTempData}},components:{UploadImages:T},mounted(){this.editProductModal=new A(this.$refs.editProductModal),console.log(this.tempData)}},L={id:"editProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"editProductModalLabel","aria-hidden":"true",ref:"editProductModal"},C={class:"modal-dialog modal-xl"},N={class:"modal-content border-0"},R={class:"modal-header bg-dark text-white"},O={id:"editProductModalLabel",class:"modal-title"},B={key:0},H={key:1},S=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),$={class:"modal-body"},F={class:"row"},G={class:"col-sm-4"},J={class:"mb-3"},z=t("label",{for:"imageUrl",class:"form-label"},"主要圖片",-1),X=["src"],Y=t("h3",{class:"mb-3"},"次要圖片",-1),j={key:0},q={class:"mb-3"},K=t("label",{for:"imageUrl"}," 圖片網址",-1),Q=["onUpdate:modelValue"],W=["src"],Z={key:0},tt={key:1},et={key:1},ot={class:"col-sm-8"},st={class:"mb-3"},lt=t("label",{for:"title",class:"form-label"},"標題",-1),it={class:"row"},at={class:"mb-3 col-md-6"},nt=t("label",{for:"category",class:"form-label"},"分類",-1),dt={class:"mb-3 col-md-6"},rt=t("label",{for:"price",class:"form-label"},"單位",-1),ct={class:"row"},mt={class:"mb-3 col-md-6"},pt=t("label",{for:"origin_price",class:"form-label"},"原價",-1),ut={class:"mb-3 col-md-6"},_t=t("label",{for:"price",class:"form-label"},"售價",-1),ht=t("hr",null,null,-1),bt={class:"row"},ft={class:"mb-3 col-md-12"},gt=t("label",{for:"flavor",class:"form-label"},"口味",-1),Dt={class:"mb-3"},Pt=t("label",{for:"description",class:"form-label"},"產品描述",-1),vt={class:"mb-3"},yt=t("label",{for:"content",class:"form-label"},"說明內容",-1),Ut={class:"mb-3"},kt={class:"form-check"},wt={class:"form-check-label",for:"is_enabled"},Mt={class:"modal-footer"};function Vt(l,e,m,w,o,i){const b=_("UploadImages");return a(),n("div",L,[t("div",C,[t("div",N,[t("div",R,[t("h5",O,[m.isNew?(a(),n("span",B,"新增產品")):(a(),n("span",H,"編輯產品"))]),S]),t("div",$,[t("div",F,[t("div",G,[h(b),t("div",J,[z,r(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.tempData.imageUrl=s),type:"text",class:"form-control mb-2",placeholder:"請輸入圖片連結"},null,512),[[c,o.tempData.imageUrl]]),t("img",{class:"img-fluid",src:o.tempData.imageUrl},null,8,X)]),Y,Array.isArray(o.tempData.imagesUrl)?(a(),n("div",j,[(a(!0),n(g,null,U(o.tempData.imagesUrl,(s,p)=>(a(),n("div",{class:"mb-1",key:p},[t("div",q,[K,r(t("input",{type:"text","onUpdate:modelValue":d=>o.tempData.imagesUrl[p]=d,class:"form-control",placeholder:"請輸入圖片連結"},null,8,Q),[[c,o.tempData.imagesUrl[p]]])]),t("img",{class:"img-fluid",src:s,alt:""},null,8,W)]))),128)),o.tempData.imagesUrl.length==0||o.tempData.imagesUrl[o.tempData.imagesUrl.length-1]?(a(),n("div",Z,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[1]||(e[1]=s=>o.tempData.imagesUrl.push(""))}," 新增圖片2 ")])):(a(),n("div",tt,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm d-block w-100",onClick:e[2]||(e[2]=s=>o.tempData.imagesUrl.pop())}," 刪除圖片 ")]))])):(a(),n("div",et,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[3]||(e[3]=(...s)=>i.createImage&&i.createImage(...s))}," 新增圖片1 ")]))]),t("div",ot,[t("div",st,[lt,r(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[4]||(e[4]=s=>o.tempData.title=s)},null,512),[[c,o.tempData.title]])]),t("div",it,[t("div",at,[nt,r(t("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":e[5]||(e[5]=s=>o.tempData.category=s)},null,512),[[c,o.tempData.category]])]),t("div",dt,[rt,r(t("input",{id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":e[6]||(e[6]=s=>o.tempData.unit=s)},null,512),[[c,o.tempData.unit]])])]),t("div",ct,[t("div",mt,[pt,r(t("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入原價","onUpdate:modelValue":e[7]||(e[7]=s=>o.tempData.origin_price=s)},null,512),[[c,o.tempData.origin_price,void 0,{number:!0}]])]),t("div",ut,[_t,r(t("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:"請輸入售價","onUpdate:modelValue":e[8]||(e[8]=s=>o.tempData.price=s)},null,512),[[c,o.tempData.price,void 0,{number:!0}]])])]),ht,t("div",bt,[t("div",ft,[gt,r(t("input",{id:"flavor",type:"text",class:"form-control",placeholder:"請輸入口味","onUpdate:modelValue":e[9]||(e[9]=s=>o.tempData.flavor=s)},null,512),[[c,o.tempData.flavor,void 0,{number:!0}]])])]),t("div",Dt,[Pt,r(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":e[10]||(e[10]=s=>o.tempData.description=s)},`
                `,512),[[c,o.tempData.description]])]),t("div",vt,[yt,r(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":e[11]||(e[11]=s=>o.tempData.content=s)},`
                `,512),[[c,o.tempData.content]])]),t("div",Ut,[t("div",kt,[r(t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[12]||(e[12]=s=>o.tempData.is_enabled=s),"true-value":1,"false-value":0},null,512),[[I,o.tempData.is_enabled]]),t("label",wt,u(o.tempData.is_enabled?"啟用":"不啟用"),1)])])])])]),t("div",Mt,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:e[13]||(e[13]=(...s)=>i.hide&&i.hide(...s))}," 取消 "),t("button",{type:"button",class:"btn btn-primary",onClick:e[14]||(e[14]=(...s)=>i.confirm&&i.confirm(...s))}," 確認 ")])])])],512)}const xt=k(E,[["render",Vt]]),{VITE_APP_URL:v,VITE_APP_PATH:y}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"week3dean",BASE_URL:"/iiincookie-vue/",MODE:"production",DEV:!1,PROD:!0},Tt={data(){return{products:[],pagination:{},isNew:!1,tempData:{imagesUrl:[],flavor:"",is_enabled:1}}},methods:{getProductList(l=1){this.$http.get(`${v}/api/${y}/admin/products/?page=${l}`).then(e=>{this.pagination=e.data.pagination,this.products=e.data.products}).catch(e=>{f.fire({icon:"error",title:`${e.response.data.message}`})})},openModal(l,e){l==="new"?(this.tempData={imagesUrl:[],is_enabled:1},this.$refs.editProductModal.show(),this.isNew=!0):l==="edit"?(this.$refs.editProductModal.show(),this.tempData={...e},this.isNew=!1):l==="delete"&&(this.$refs.deleteModal.show(),this.tempData={...e},this.isNew=!1)},deleteProduct(){this.$http.delete(`${v}/api/${y}/admin/product/${this.tempData.id}`).then(l=>{alert(l.data.message),this.$refs.deleteModal.hide(),this.getProductList()}).catch(l=>{alert(l.response.data.message)})}},components:{ProductModal:xt,DeleteModal:V,PaginationComponent:x},mounted(){const l=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=l,this.getProductList()}},At=t("h1",{class:"fs-2xl border-bottom border-secondary pb-2"},"產品管理",-1),It={class:"text-end mt-4"},Et={class:"table mt-4"},Lt=t("thead",null,[t("tr",null,[t("th",{width:"120"},"分類"),t("th",null,"產品名稱"),t("th",{width:"120"},"原價"),t("th",{width:"120"},"售價"),t("th",{width:"100"},"是否啟用"),t("th",{width:"120"},"編輯")])],-1),Ct={key:0,class:"text-success"},Nt={key:1},Rt={class:"btn-group"},Ot=["onClick"],Bt=["onClick"];function Ht(l,e,m,w,o,i){const b=_("PaginationComponent"),s=_("ProductModal"),p=_("DeleteModal");return a(),n(g,null,[At,t("div",null,[t("div",It,[t("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=d=>i.openModal("new",l.product))}," 建立新產品 ")]),t("table",Et,[Lt,t("tbody",null,[(a(!0),n(g,null,U(o.products,d=>(a(),n("tr",{key:d.id},[t("td",null,u(d.category),1),t("td",null,u(d.title),1),t("td",null,"NT$"+u(d.origin_price),1),t("td",null,"NT$"+u(d.price),1),t("td",null,[d.is_enabled?(a(),n("span",Ct,"啟用")):(a(),n("span",Nt,"未啟用"))]),t("td",null,[t("div",Rt,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:M=>i.openModal("edit",d)}," 編輯 ",8,Ot),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:M=>i.openModal("delete",d)}," 刪除 ",8,Bt)])])]))),128))])]),h(b,{"page-in":o.pagination,onGetPages:i.getProductList},null,8,["page-in","onGetPages"])]),h(s,{"inner-temp-data":o.tempData,onUpdate:i.getProductList,"is-new":o.isNew,ref:"editProductModal"},null,8,["inner-temp-data","onUpdate","is-new"]),h(p,{deleteItem:o.tempData,onUpdate:i.getProductList,onDelItem:i.deleteProduct,ref:"deleteModal"},null,8,["deleteItem","onUpdate","onDelItem"])],64)}const ne=k(Tt,[["render",Ht]]);export{ne as default};
